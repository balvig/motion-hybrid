// Generated by CoffeeScript 1.7.1
(function() {
  window.MotionHybrid = (function() {
    var parseButton, parseFlash;

    function MotionHybrid() {}

    MotionHybrid.getParams = function() {
      var bridge, params;
      bridge = $('#motion_hybrid_bridge');
      params = {};
      params.title = bridge.find('h1').text();
      params.subtitle = bridge.find('h2').text();
      params.flash = parseFlash(bridge.find('.flash'));
      params.nav_bar_buttons = {};
      params.nav_bar_buttons.left = parseButton(bridge.find('#nav_bar_left_button'));
      params.nav_bar_buttons.right = parseButton(bridge.find('#nav_bar_right_button'));
      params.refreshable = $('[data-refreshable]').length > 0;
      return JSON.stringify(params);
    };

    parseFlash = function(flash) {
      if (flash.length) {
        return {
          title: flash.find('h3').text() || flash.text().trim(),
          subtitle: flash.find('p').text()
        };
      }
    };

    parseButton = function(button) {
      if (button.length) {
        return {
          id: button.attr('id'),
          options: button.children().map(function() {
            return this.innerText;
          }).get(),
          icon: button.data('icon'),
          label: button.text().trim()
        };
      }
    };

    MotionHybrid.clicked = function(target, childIndex) {
      target = $("#" + target);
      if (childIndex) {
        target = target.children();
      }
      return target.get(childIndex || 0).click();
    };

    return MotionHybrid;

  })();

  if (document.readyState === 'complete') {
    document.location.href = 'motionhybrid://ready';
  } else {
    jQuery(function() {
      return document.location.href = 'motionhybrid://ready';
    });
  }

}).call(this);
